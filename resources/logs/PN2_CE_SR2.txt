Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/pn2-msg.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='PN2_CE_SR2_eval', eval_step=1, save_step=10, ckpt_path='outputs/PointNet2_CE_SR2/models/model_last.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats='feats/PN2_CE_SR2.pt', save_tensors='resources/PN2_CE_SR2', corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
Clf - feature encoder: pn2-msg
Clf Head - num classes: 4, input dim: 1024, act: relu, dropout: 0.5
Model params count: 1.7373 M
Load weights:  <All keys matched successfully>
100% 788/788 [02:35<00:00,  5.06it/s]
100% 1255/1255 [03:58<00:00,  5.25it/s]
100% 847/847 [02:42<00:00,  5.23it/s]
Logits saved to resources/PN2_CE_SR2

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8375634517766497, Clf Bal Acc: 0.8288544079306779
SRC->TAR1:      AUROC: 0.7091, FPR95: 0.8693, AUPR_IN: 0.6457, AUPR_OUT: 0.7627
SRC->TAR2:      AUROC: 0.7072, FPR95: 0.8689, AUPR_IN: 0.7014, AUPR_OUT: 0.6836
SRC->TAR1+TAR2: AUROC: 0.7083, FPR95: 0.8692, AUPR_IN: 0.5240, AUPR_OUT: 0.8420
to spreadsheet: 0.7091021700002023,0.8693227091633466,0.6456916068296512,0.7626915654763076,0.7071921502586015,0.8689492325855962,0.7013812576093054,0.6835676368077847,0.7083325283631254,0.8691722169362512,0.5239727309610851,0.8420053964504632
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8375634517766497, Clf Bal Acc: 0.8288544079306779
SRC->TAR1:      AUROC: 0.7077, FPR95: 0.8183, AUPR_IN: 0.6358, AUPR_OUT: 0.7731
SRC->TAR2:      AUROC: 0.7022, FPR95: 0.8548, AUPR_IN: 0.6937, AUPR_OUT: 0.6828
SRC->TAR1+TAR2: AUROC: 0.7055, FPR95: 0.8330, AUPR_IN: 0.5124, AUPR_OUT: 0.8460
to spreadsheet: 0.707672861852084,0.8183266932270916,0.6358038989610552,0.7730933543740566,0.70220215870885,0.8547815820543093,0.6936899015154061,0.6828200393467792,0.7054684443628741,0.8330161750713606,0.5124492473312086,0.8460116129613587
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8375634517766497, Clf Bal Acc: 0.8288544079306779
SRC->TAR1:      AUROC: 0.7118, FPR95: 0.8558, AUPR_IN: 0.6469, AUPR_OUT: 0.7730
SRC->TAR2:      AUROC: 0.7083, FPR95: 0.8784, AUPR_IN: 0.7023, AUPR_OUT: 0.6886
SRC->TAR1+TAR2: AUROC: 0.7104, FPR95: 0.8649, AUPR_IN: 0.5252, AUPR_OUT: 0.8473
to spreadsheet: 0.7118227597225312,0.8557768924302789,0.6469021416097658,0.7729614922249135,0.7082686579687041,0.8783943329397875,0.7022672599011008,0.6886132544007026,0.7103906359425638,0.8648905803996194,0.5251950730971268,0.8473353464777552
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
  0% 0/1916 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1916/1916 [06:01<00:00,  5.30it/s]
100% 788/788 [02:29<00:00,  5.26it/s]
100% 1255/1255 [03:58<00:00,  5.26it/s]
100% 847/847 [02:41<00:00,  5.23it/s]
Features saved to feats/PN2_CE_SR2.pt
Euclidean distances in a non-normalized space:
Euclid L2 distances saved to resources/PN2_CE_SR2
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8362944162436549, Clf Bal Acc: 0.8241380624246815
SRC->TAR1:      AUROC: 0.6861, FPR95: 0.8032, AUPR_IN: 0.5712, AUPR_OUT: 0.7637
SRC->TAR2:      AUROC: 0.7157, FPR95: 0.8146, AUPR_IN: 0.6962, AUPR_OUT: 0.7076
SRC->TAR1+TAR2: AUROC: 0.6980, FPR95: 0.8078, AUPR_IN: 0.4654, AUPR_OUT: 0.8472
to spreadsheet: 0.6860921795053289,0.803187250996016,0.5711595283105728,0.7637267856610692,0.7157450302351086,0.8146399055489965,0.6962167802869572,0.7076192199263154,0.6980407830106208,0.807802093244529,0.4653809870729747,0.8472201494960214

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6970, FPR95: 0.8558, AUPR_IN: 0.6138, AUPR_OUT: 0.7641
SRC->TAR2:      AUROC: 0.6831, FPR95: 0.8937, AUPR_IN: 0.6956, AUPR_OUT: 0.6525
SRC->TAR1+TAR2: AUROC: 0.6914, FPR95: 0.8711, AUPR_IN: 0.5014, AUPR_OUT: 0.8352
to spreadsheet: 0.6970276255384553,0.8557768924302789,0.6138351107154434,0.7640725272582312,0.6831366602940208,0.8937426210153483,0.6955805841895404,0.652546746707606,0.6914302670408168,0.8710751665080876,0.5014087272540574,0.8352023629353759

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8324873096446701, Clf Bal Acc: 0.8366754121571531
SRC->TAR1:      AUROC: 0.6910, FPR95: 0.9108, AUPR_IN: 0.6002, AUPR_OUT: 0.7336
SRC->TAR2:      AUROC: 0.7192, FPR95: 0.9280, AUPR_IN: 0.7251, AUPR_OUT: 0.6686
SRC->TAR1+TAR2: AUROC: 0.7023, FPR95: 0.9177, AUPR_IN: 0.5026, AUPR_OUT: 0.8259
to spreadsheet: 0.6909590066131414,0.9107569721115538,0.6001854699426978,0.7335823005868816,0.7191820638982614,0.9279811097992916,0.7250944102432932,0.6685603089389617,0.7023314754620931,0.917697431018078,0.5026212883352397,0.8258674499409806

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6638, FPR95: 0.9044, AUPR_IN: 0.5633, AUPR_OUT: 0.7143
SRC->TAR2:      AUROC: 0.6963, FPR95: 0.9209, AUPR_IN: 0.7004, AUPR_OUT: 0.6488
SRC->TAR1+TAR2: AUROC: 0.6769, FPR95: 0.9110, AUPR_IN: 0.4653, AUPR_OUT: 0.8119
to spreadsheet: 0.6638193419216536,0.9043824701195219,0.5633417664394567,0.7142926251615769,0.6962592668061057,0.9208972845336482,0.7004437731363152,0.6487520507323219,0.6768909957642468,0.9110371075166508,0.4653431861311876,0.8118743985260168
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [05:40<00:00,  2.31it/s]
100% 1255/1255 [09:07<00:00,  2.29it/s]
100% 847/847 [06:11<00:00,  2.28it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7177, FPR95: 0.8359, AUPR_IN: 0.6532, AUPR_OUT: 0.7759
SRC->TAR2:      AUROC: 0.7137, FPR95: 0.8701, AUPR_IN: 0.7127, AUPR_OUT: 0.6864
SRC->TAR1+TAR2: AUROC: 0.7161, FPR95: 0.8497, AUPR_IN: 0.5364, AUPR_OUT: 0.8484
to spreadsheet: 0.7176815580318321,0.8358565737051793,0.6531531091384658,0.7759485243902364,0.7136534439257097,0.8701298701298701,0.7127090642236498,0.6863883320755303,0.716058431177462,0.8496669838249287,0.5364349249237128,0.8484299794402886
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [02:38<00:00,  4.97it/s]
100% 1255/1255 [04:14<00:00,  4.94it/s]
100% 788/788 [02:53<00:00,  4.55it/s]
100% 1255/1255 [04:32<00:00,  4.61it/s]
100% 847/847 [03:06<00:00,  4.55it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7419, FPR95: 0.8143, AUPR_IN: 0.6709, AUPR_OUT: 0.7896
SRC->TAR2:      AUROC: 0.7066, FPR95: 0.8607, AUPR_IN: 0.6956, AUPR_OUT: 0.6798
SRC->TAR1+TAR2: AUROC: 0.7277, FPR95: 0.8330, AUPR_IN: 0.5338, AUPR_OUT: 0.8530
to spreadsheet: 0.741941877161405,0.8143426294820717,0.6709291519430294,0.7896170812260753,0.7066370408548535,0.8606847697756789,0.6955900124399641,0.6797685176073496,0.7277158084879278,0.8330161750713606,0.533844135166476,0.8530074102337967
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 486/486 [01:38<00:00,  4.96it/s]
t = 1.6708
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=1.6708)...
React - using SR2 test to compute threshold
100% 788/788 [02:41<00:00,  4.88it/s]
100% 1255/1255 [04:19<00:00,  4.84it/s]
100% 847/847 [02:53<00:00,  4.88it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7049, FPR95: 0.8398, AUPR_IN: 0.6292, AUPR_OUT: 0.7728
SRC->TAR2:      AUROC: 0.7047, FPR95: 0.8808, AUPR_IN: 0.7015, AUPR_OUT: 0.6795
SRC->TAR1+TAR2: AUROC: 0.7048, FPR95: 0.8563, AUPR_IN: 0.5138, AUPR_OUT: 0.8454
to spreadsheet: 0.704859748821971,0.8398406374501992,0.6291948088054876,0.7728263869286044,0.7047267453358823,0.8807556080283353,0.7015486466498607,0.679542903825624,0.7048061551241988,0.8563273073263559,0.5138311235337788,0.8453943258021893
################################################################################