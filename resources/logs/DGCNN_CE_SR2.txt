Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR2_eval', eval_step=1, save_step=10, ckpt_path='outputs/DGCNN_CE_SR2/models/model_last.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats='feats/DGCNN_CE_SR2.pt', save_tensors='resources/DGCNN_CE_SR2', corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 4, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8001 M
Load weights:  <All keys matched successfully>
100% 788/788 [00:16<00:00, 46.83it/s]
100% 1255/1255 [00:26<00:00, 47.99it/s]
100% 847/847 [00:17<00:00, 48.25it/s]
Logits saved to resources/DGCNN_CE_SR2

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6789340101522843, Clf Bal Acc: 0.6022211645476704
SRC->TAR1:      AUROC: 0.5939, FPR95: 0.9052, AUPR_IN: 0.4642, AUPR_OUT: 0.6887
SRC->TAR2:      AUROC: 0.6474, FPR95: 0.8937, AUPR_IN: 0.6311, AUPR_OUT: 0.6349
SRC->TAR1+TAR2: AUROC: 0.6155, FPR95: 0.9006, AUPR_IN: 0.3672, AUPR_OUT: 0.7966
to spreadsheet: 0.5939374481768358,0.9051792828685259,0.46416008295916367,0.6886695422564082,0.6473631928754218,0.8937426210153483,0.6310619142264344,0.6348583127325087,0.615465329128169,0.9005708848715509,0.367161604441528,0.7965780728296818
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6789340101522843, Clf Bal Acc: 0.6022211645476704
SRC->TAR1:      AUROC: 0.6557, FPR95: 0.8916, AUPR_IN: 0.5173, AUPR_OUT: 0.7372
SRC->TAR2:      AUROC: 0.6517, FPR95: 0.8843, AUPR_IN: 0.6203, AUPR_OUT: 0.6478
SRC->TAR1+TAR2: AUROC: 0.6541, FPR95: 0.8887, AUPR_IN: 0.3955, AUPR_OUT: 0.8212
to spreadsheet: 0.6557455457358384,0.8916334661354581,0.5172633112307863,0.737220932193427,0.6517403915881073,0.8842975206611571,0.620268427121258,0.6477949700067069,0.6541316705868716,0.8886774500475737,0.39554270044853235,0.8212139158392067
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6789340101522843, Clf Bal Acc: 0.6022211645476704
SRC->TAR1:      AUROC: 0.5995, FPR95: 0.9020, AUPR_IN: 0.4657, AUPR_OUT: 0.6970
SRC->TAR2:      AUROC: 0.6513, FPR95: 0.8914, AUPR_IN: 0.6317, AUPR_OUT: 0.6408
SRC->TAR1+TAR2: AUROC: 0.6204, FPR95: 0.8977, AUPR_IN: 0.3681, AUPR_OUT: 0.8017
to spreadsheet: 0.5995480008898417,0.90199203187251,0.4656573208584423,0.6970322630581988,0.6513388549613747,0.8913813459268005,0.6316544674785536,0.6408421987531062,0.6204171033630046,0.8977164605137964,0.3680695566695536,0.8016914814338083
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
  0% 0/1916 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1916/1916 [00:13<00:00, 146.39it/s]
100% 788/788 [00:16<00:00, 48.67it/s]
100% 1255/1255 [00:25<00:00, 48.54it/s]
100% 847/847 [00:17<00:00, 48.38it/s]
Features saved to feats/DGCNN_CE_SR2.pt
Euclidean distances in a non-normalized space:
Euclid L2 distances saved to resources/DGCNN_CE_SR2
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6979695431472082, Clf Bal Acc: 0.6080671295096576
SRC->TAR1:      AUROC: 0.6272, FPR95: 0.9251, AUPR_IN: 0.5313, AUPR_OUT: 0.6944
SRC->TAR2:      AUROC: 0.6910, FPR95: 0.8430, AUPR_IN: 0.6793, AUPR_OUT: 0.6802
SRC->TAR1+TAR2: AUROC: 0.6529, FPR95: 0.8920, AUPR_IN: 0.4353, AUPR_OUT: 0.8121
to spreadsheet: 0.6271543268550165,0.9250996015936255,0.5313398128556679,0.6943800162193199,0.6910183148646462,0.8429752066115702,0.6792962229516345,0.6802046895924199,0.6528882934792583,0.8920076117982874,0.4353232048288132,0.812114694805567

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.5779, FPR95: 0.9586, AUPR_IN: 0.4836, AUPR_OUT: 0.6430
SRC->TAR2:      AUROC: 0.5580, FPR95: 0.9717, AUPR_IN: 0.5841, AUPR_OUT: 0.5251
SRC->TAR1+TAR2: AUROC: 0.5699, FPR95: 0.9638, AUPR_IN: 0.3677, AUPR_OUT: 0.7423
to spreadsheet: 0.5779349606649544,0.9585657370517928,0.4835544739171781,0.6429524107552353,0.5579995684979534,0.9716646989374262,0.5840521829214275,0.5251252700373279,0.5699020029268717,0.9638439581351094,0.3677003252366402,0.7423139944126618

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.699238578680203, Clf Bal Acc: 0.6140488741620664
SRC->TAR1:      AUROC: 0.6844, FPR95: 0.8980, AUPR_IN: 0.5879, AUPR_OUT: 0.7407
SRC->TAR2:      AUROC: 0.6972, FPR95: 0.8713, AUPR_IN: 0.6881, AUPR_OUT: 0.6770
SRC->TAR1+TAR2: AUROC: 0.6896, FPR95: 0.8873, AUPR_IN: 0.4771, AUPR_OUT: 0.8309
to spreadsheet: 0.6843873238012418,0.8980079681274901,0.5879422142206826,0.7407190673907786,0.697206923210615,0.8713105076741441,0.688131279042449,0.6769803496570492,0.6895529758943622,0.8872502378686965,0.4770551094506831,0.830875343322542

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6068, FPR95: 0.9355, AUPR_IN: 0.5040, AUPR_OUT: 0.6771
SRC->TAR2:      AUROC: 0.6373, FPR95: 0.9315, AUPR_IN: 0.6516, AUPR_OUT: 0.6055
SRC->TAR1+TAR2: AUROC: 0.6191, FPR95: 0.9339, AUPR_IN: 0.4047, AUPR_OUT: 0.7837
to spreadsheet: 0.6067688636317673,0.9354581673306773,0.5039599146547205,0.677120557088187,0.6373060488196621,0.9315230224321134,0.6516172306848383,0.605451073337133,0.6190738093283168,0.933872502378687,0.4046970103498563,0.7837345519312546
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [00:44<00:00, 17.74it/s]
100% 1255/1255 [01:09<00:00, 18.08it/s]
100% 847/847 [00:46<00:00, 18.06it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6563, FPR95: 0.8932, AUPR_IN: 0.5182, AUPR_OUT: 0.7380
SRC->TAR2:      AUROC: 0.6529, FPR95: 0.8843, AUPR_IN: 0.6216, AUPR_OUT: 0.6485
SRC->TAR1+TAR2: AUROC: 0.6550, FPR95: 0.8896, AUPR_IN: 0.3967, AUPR_OUT: 0.8217
to spreadsheet: 0.6563234372156046,0.8932270916334661,0.5181603844207281,0.7379725370168394,0.6529157851838978,0.8842975206611571,0.6216092938486824,0.6484620706131443,0.6549503252884611,0.8896289248334919,0.3966546144063561,0.821688217255106
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [00:17<00:00, 44.21it/s]
100% 1255/1255 [00:27<00:00, 45.05it/s]
100% 847/847 [00:18<00:00, 44.60it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6584, FPR95: 0.8805, AUPR_IN: 0.5187, AUPR_OUT: 0.7397
SRC->TAR2:      AUROC: 0.6511, FPR95: 0.8737, AUPR_IN: 0.6194, AUPR_OUT: 0.6470
SRC->TAR1+TAR2: AUROC: 0.6555, FPR95: 0.8777, AUPR_IN: 0.3959, AUPR_OUT: 0.8221
to spreadsheet: 0.6583877687220661,0.8804780876494024,0.5186958096277492,0.7397273165833869,0.6511425814609939,0.8736717827626919,0.61944237085539,0.6470425439689724,0.6554683236173429,0.8777354900095148,0.3959446151773664,0.8220752296077487
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [00:27<00:00, 29.10it/s]
100% 1255/1255 [00:43<00:00, 29.05it/s]
100% 847/847 [00:29<00:00, 28.99it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6458, FPR95: 0.8773, AUPR_IN: 0.5312, AUPR_OUT: 0.7290
SRC->TAR2:      AUROC: 0.6054, FPR95: 0.8914, AUPR_IN: 0.5813, AUPR_OUT: 0.6084
SRC->TAR1+TAR2: AUROC: 0.6296, FPR95: 0.8830, AUPR_IN: 0.3905, AUPR_OUT: 0.8076
to spreadsheet: 0.6458298784557202,0.8772908366533865,0.5311878211650694,0.7289845048638406,0.605442319563224,0.8913813459268005,0.5812745524281205,0.6084204703314229,0.6295557288924737,0.8829686013320647,0.39045201053256273,0.8075837142184543
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 486/486 [00:04<00:00, 113.95it/s]
t = 2.8478
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=2.8478)...
React - using SR2 test to compute threshold
100% 788/788 [00:17<00:00, 43.87it/s]
100% 1255/1255 [00:27<00:00, 44.97it/s]
100% 847/847 [00:18<00:00, 44.58it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6654, FPR95: 0.8797, AUPR_IN: 0.5377, AUPR_OUT: 0.7420
SRC->TAR2:      AUROC: 0.6577, FPR95: 0.8737, AUPR_IN: 0.6399, AUPR_OUT: 0.6495
SRC->TAR1+TAR2: AUROC: 0.6623, FPR95: 0.8773, AUPR_IN: 0.4195, AUPR_OUT: 0.8239
to spreadsheet: 0.6654013388072078,0.8796812749003984,0.537722951975842,0.7419766972683657,0.6576720464583871,0.8736717827626919,0.6398592680431092,0.6495011331449082,0.6622868237646524,0.8772597526165556,0.4194767830893885,0.8238680800404885
################################################################################
[15]
1 h
!python classifiers/trainer_cla_md_project.py --config cfgs/pn2-msg.yaml --exp_name PN2_CE_SR1_eval --src SR1 --loss CE -mode eval --ckpt_path outputs/PointNet2_CE_SR1/models/model_last.pth  --save_feats feats/PN2_CE_SR1.pt --save_tensors resources/PN2_CE_SR1
Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/pn2-msg.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='PN2_CE_SR1_eval', eval_step=1, save_step=10, ckpt_path='outputs/PointNet2_CE_SR1/models/model_last.pth', src='SR1', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats='feats/PN2_CE_SR1.pt', save_tensors='resources/PN2_CE_SR1', corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_train.h5
ModelNet40_OOD - split: train, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
SR1 train data len: 2378
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR1

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
Clf - feature encoder: pn2-msg
Clf Head - num classes: 5, input dim: 1024, act: relu, dropout: 0.5
Model params count: 1.7376 M
Load weights:  <All keys matched successfully>
100% 1255/1255 [04:09<00:00,  5.02it/s]
100% 788/788 [02:36<00:00,  5.05it/s]
100% 847/847 [02:46<00:00,  5.08it/s]
Logits saved to resources/PN2_CE_SR1

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7880478087649403, Clf Bal Acc: 0.7601842402730187
SRC->TAR1:      AUROC: 0.8303, FPR95: 0.7855, AUPR_IN: 0.9065, AUPR_OUT: 0.6871
SRC->TAR2:      AUROC: 0.8007, FPR95: 0.8229, AUPR_IN: 0.8756, AUPR_OUT: 0.6633
SRC->TAR1+TAR2: AUROC: 0.8150, FPR95: 0.8049, AUPR_IN: 0.8227, AUPR_OUT: 0.8040
to spreadsheet: 0.8303289380548871,0.7855329949238579,0.9065104031623847,0.6871404321523343,0.8007013269237102,0.8229043683589138,0.8755987893755842,0.6633121305918973,0.814980567028522,0.8048929663608563,0.8226556835310523,0.8040031547577298
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7880478087649403, Clf Bal Acc: 0.7601842402730187
SRC->TAR1:      AUROC: 0.8387, FPR95: 0.7881, AUPR_IN: 0.9105, AUPR_OUT: 0.7079
SRC->TAR2:      AUROC: 0.8159, FPR95: 0.7780, AUPR_IN: 0.8798, AUPR_OUT: 0.7112
SRC->TAR1+TAR2: AUROC: 0.8269, FPR95: 0.7829, AUPR_IN: 0.8273, AUPR_OUT: 0.8269
to spreadsheet: 0.8386757538374422,0.7880710659898477,0.9104651407355374,0.7079355707311209,0.8158807509042931,0.7780401416765053,0.87978986774341,0.7111605209406514,0.8268669663852236,0.7828746177370031,0.8273126588884004,0.8268693118924689
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7880478087649403, Clf Bal Acc: 0.7601842402730187
SRC->TAR1:      AUROC: 0.8318, FPR95: 0.7893, AUPR_IN: 0.9070, AUPR_OUT: 0.6944
SRC->TAR2:      AUROC: 0.8040, FPR95: 0.8146, AUPR_IN: 0.8766, AUPR_OUT: 0.6819
SRC->TAR1+TAR2: AUROC: 0.8174, FPR95: 0.8024, AUPR_IN: 0.8235, AUPR_OUT: 0.8123
to spreadsheet: 0.8317663356725383,0.7893401015228426,0.9070355766189591,0.6944332033615486,0.8040311010973814,0.8146399055489965,0.8765753418908828,0.6819068699374782,0.8173982967213713,0.8024464831804281,0.8235030671931509,0.8123158373112521
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
  0% 0/2378 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 2378/2378 [07:45<00:00,  5.11it/s]
100% 1255/1255 [04:08<00:00,  5.06it/s]
100% 788/788 [02:36<00:00,  5.04it/s]
100% 847/847 [02:48<00:00,  5.04it/s]
Features saved to feats/PN2_CE_SR1.pt
Euclidean distances in a non-normalized space:
Euclid L2 distances saved to resources/PN2_CE_SR1
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7800796812749003, Clf Bal Acc: 0.7295998579845964
SRC->TAR1:      AUROC: 0.7895, FPR95: 0.8503, AUPR_IN: 0.8799, AUPR_OUT: 0.6085
SRC->TAR2:      AUROC: 0.7768, FPR95: 0.8264, AUPR_IN: 0.8472, AUPR_OUT: 0.6427
SRC->TAR1+TAR2: AUROC: 0.7829, FPR95: 0.8379, AUPR_IN: 0.7774, AUPR_OUT: 0.7694
to spreadsheet: 0.7894938014439704,0.850253807106599,0.8798888999190877,0.6084914664513121,0.7768228149973893,0.8264462809917356,0.847211419736851,0.6427360525895374,0.7829296879759251,0.8379204892966361,0.7774411210532254,0.7694447151801402

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.21274900398406374, Clf Bal Acc: 0.2
SRC->TAR1:      AUROC: 0.7910, FPR95: 0.8718, AUPR_IN: 0.8820, AUPR_OUT: 0.6166
SRC->TAR2:      AUROC: 0.7484, FPR95: 0.8902, AUPR_IN: 0.8264, AUPR_OUT: 0.5909
SRC->TAR1+TAR2: AUROC: 0.7689, FPR95: 0.8813, AUPR_IN: 0.7622, AUPR_OUT: 0.7517
to spreadsheet: 0.7910146217161811,0.8718274111675127,0.8819696355840989,0.6166187718303812,0.7484131949180844,0.8902007083825265,0.826390589454652,0.5909200843367872,0.7689452587204698,0.8813455657492355,0.7621580550710478,0.7516856966893621

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.803187250996016, Clf Bal Acc: 0.774792246099795
SRC->TAR1:      AUROC: 0.8051, FPR95: 0.8135, AUPR_IN: 0.8870, AUPR_OUT: 0.6498
SRC->TAR2:      AUROC: 0.7810, FPR95: 0.8347, AUPR_IN: 0.8510, AUPR_OUT: 0.6411
SRC->TAR1+TAR2: AUROC: 0.7926, FPR95: 0.8245, AUPR_IN: 0.7852, AUPR_OUT: 0.7826
to spreadsheet: 0.805130240459482,0.8134517766497462,0.8870414151241452,0.6498173334489296,0.7810373617689808,0.8347107438016529,0.851036970041004,0.6411158454203233,0.7926490977984089,0.8244648318042813,0.7851983874406041,0.7826083909230896

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.21274900398406374, Clf Bal Acc: 0.2
SRC->TAR1:      AUROC: 0.7614, FPR95: 0.8376, AUPR_IN: 0.8530, AUPR_OUT: 0.6011
SRC->TAR2:      AUROC: 0.7198, FPR95: 0.9150, AUPR_IN: 0.8037, AUPR_OUT: 0.5591
SRC->TAR1+TAR2: AUROC: 0.7398, FPR95: 0.8777, AUPR_IN: 0.7222, AUPR_OUT: 0.7326
to spreadsheet: 0.7613576152243817,0.8375634517766497,0.8529550069460322,0.6010785867032618,0.7197547472447872,0.9149940968122786,0.8036954187753376,0.5591472591689269,0.7398055484484083,0.8776758409785933,0.722155527320184,0.7325676512285965
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
  0% 0/1255 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1255/1255 [09:18<00:00,  2.25it/s]
100% 788/788 [05:49<00:00,  2.26it/s]
100% 847/847 [06:16<00:00,  2.25it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8285, FPR95: 0.8058, AUPR_IN: 0.9042, AUPR_OUT: 0.6871
SRC->TAR2:      AUROC: 0.8074, FPR95: 0.7863, AUPR_IN: 0.8706, AUPR_OUT: 0.7021
SRC->TAR1+TAR2: AUROC: 0.8175, FPR95: 0.7957, AUPR_IN: 0.8145, AUPR_OUT: 0.8172
to spreadsheet: 0.8284880781442757,0.8058375634517766,0.9042252038644472,0.6871410485175186,0.8073585234034347,0.7863046044864227,0.87057955520692,0.7021316786291717,0.817542064159265,0.7957186544342507,0.8144773597298252,0.8171597716893024
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
  0% 0/1255 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1255/1255 [04:21<00:00,  4.81it/s]
100% 788/788 [02:41<00:00,  4.88it/s]
100% 847/847 [02:54<00:00,  4.84it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8388, FPR95: 0.8033, AUPR_IN: 0.9097, AUPR_OUT: 0.6983
SRC->TAR2:      AUROC: 0.8221, FPR95: 0.7226, AUPR_IN: 0.8818, AUPR_OUT: 0.7226
SRC->TAR1+TAR2: AUROC: 0.8301, FPR95: 0.7615, AUPR_IN: 0.8277, AUPR_OUT: 0.8288
to spreadsheet: 0.8388415879628693,0.8032994923857868,0.9097181330842716,0.698253576267442,0.8220548737752649,0.7225501770956316,0.8818073829491955,0.7225838420310158,0.8301453513164467,0.7614678899082569,0.8276960235554203,0.8288128892519455
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...
  0% 0/1255 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1255/1255 [04:32<00:00,  4.61it/s]
100% 788/788 [02:53<00:00,  4.55it/s]
100% 847/847 [03:08<00:00,  4.49it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8120, FPR95: 0.7805, AUPR_IN: 0.8866, AUPR_OUT: 0.6754
SRC->TAR2:      AUROC: 0.7776, FPR95: 0.7651, AUPR_IN: 0.8322, AUPR_OUT: 0.6720
SRC->TAR1+TAR2: AUROC: 0.7942, FPR95: 0.7725, AUPR_IN: 0.7653, AUPR_OUT: 0.8015
to spreadsheet: 0.8119501688676765,0.7804568527918782,0.8866423342659469,0.6754054159811542,0.7775914053349765,0.7650531286894924,0.8322326078375726,0.6720102304016813,0.7941508583403389,0.7724770642201835,0.7652877090315234,0.8014583419955816
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
React Val - SR1 data len: 340
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 340/340 [01:10<00:00,  4.82it/s]
t = 1.4131
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=1.4131)...
React - using SR1 test to compute threshold
100% 1255/1255 [04:24<00:00,  4.74it/s]
100% 788/788 [02:45<00:00,  4.77it/s]
100% 847/847 [02:54<00:00,  4.85it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8195, FPR95: 0.7386, AUPR_IN: 0.8891, AUPR_OUT: 0.6929
SRC->TAR2:      AUROC: 0.8164, FPR95: 0.7166, AUPR_IN: 0.8765, AUPR_OUT: 0.7223
SRC->TAR1+TAR2: AUROC: 0.8179, FPR95: 0.7272, AUPR_IN: 0.8059, AUPR_OUT: 0.8258
to spreadsheet: 0.819534046554897,0.7385786802030457,0.8891000204451359,0.6929205501030092,0.8164461398796785,0.7166469893742621,0.8764664480762396,0.7223196224181614,0.8179343786931783,0.727217125382263,0.8059463820618571,0.8257501765802655
################################################################################