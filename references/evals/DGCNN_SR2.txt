Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR2_eval', eval_step=1, save_step=10, ckpt_path='outputs/DGCNN_CE_SR2/models/model_last.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 4, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8001 M
Load weights:  <All keys matched successfully>
100% 788/788 [00:15<00:00, 49.57it/s]
100% 1255/1255 [00:24<00:00, 50.51it/s]
100% 847/847 [00:16<00:00, 49.87it/s]

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6789340101522843, Clf Bal Acc: 0.6022211645476704
SRC->TAR1:      AUROC: 0.5939, FPR95: 0.9052, AUPR_IN: 0.4642, AUPR_OUT: 0.6887
SRC->TAR2:      AUROC: 0.6474, FPR95: 0.8937, AUPR_IN: 0.6311, AUPR_OUT: 0.6349
SRC->TAR1+TAR2: AUROC: 0.6155, FPR95: 0.9006, AUPR_IN: 0.3672, AUPR_OUT: 0.7966
to spreadsheet: 0.5939374481768358,0.9051792828685259,0.46416008295916367,0.6886695422564082,0.6473631928754218,0.8937426210153483,0.6310619142264344,0.6348583127325087,0.615465329128169,0.9005708848715509,0.367161604441528,0.7965780728296818
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6789340101522843, Clf Bal Acc: 0.6022211645476704
SRC->TAR1:      AUROC: 0.6557, FPR95: 0.8916, AUPR_IN: 0.5173, AUPR_OUT: 0.7372
SRC->TAR2:      AUROC: 0.6517, FPR95: 0.8843, AUPR_IN: 0.6203, AUPR_OUT: 0.6478
SRC->TAR1+TAR2: AUROC: 0.6541, FPR95: 0.8887, AUPR_IN: 0.3955, AUPR_OUT: 0.8212
to spreadsheet: 0.6557455457358384,0.8916334661354581,0.5172633112307863,0.737220932193427,0.6517403915881073,0.8842975206611571,0.620268427121258,0.6477949700067069,0.6541316705868716,0.8886774500475737,0.39554270044853235,0.8212139158392067
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6789340101522843, Clf Bal Acc: 0.6022211645476704
SRC->TAR1:      AUROC: 0.5995, FPR95: 0.9020, AUPR_IN: 0.4657, AUPR_OUT: 0.6970
SRC->TAR2:      AUROC: 0.6513, FPR95: 0.8914, AUPR_IN: 0.6317, AUPR_OUT: 0.6408
SRC->TAR1+TAR2: AUROC: 0.6204, FPR95: 0.8977, AUPR_IN: 0.3681, AUPR_OUT: 0.8017
to spreadsheet: 0.5995480008898417,0.90199203187251,0.4656573208584423,0.6970322630581988,0.6513388549613747,0.8913813459268005,0.6316544674785536,0.6408421987531062,0.6204171033630046,0.8977164605137964,0.3680695566695536,0.8016914814338083
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
  0% 0/1916 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1916/1916 [00:12<00:00, 152.62it/s]
100% 788/788 [00:15<00:00, 49.47it/s]
100% 1255/1255 [00:25<00:00, 49.50it/s]
100% 847/847 [00:17<00:00, 49.52it/s]
Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6979695431472082, Clf Bal Acc: 0.6080671295096576
SRC->TAR1:      AUROC: 0.6272, FPR95: 0.9251, AUPR_IN: 0.5313, AUPR_OUT: 0.6944
SRC->TAR2:      AUROC: 0.6910, FPR95: 0.8430, AUPR_IN: 0.6793, AUPR_OUT: 0.6802
SRC->TAR1+TAR2: AUROC: 0.6529, FPR95: 0.8920, AUPR_IN: 0.4353, AUPR_OUT: 0.8121
to spreadsheet: 0.6271543268550165,0.9250996015936255,0.5313398128556679,0.6943800162193199,0.6910183148646462,0.8429752066115702,0.6792962229516345,0.6802046895924199,0.6528882934792583,0.8920076117982874,0.4353232048288132,0.812114694805567

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.5779, FPR95: 0.9586, AUPR_IN: 0.4836, AUPR_OUT: 0.6430
SRC->TAR2:      AUROC: 0.5580, FPR95: 0.9717, AUPR_IN: 0.5841, AUPR_OUT: 0.5251
SRC->TAR1+TAR2: AUROC: 0.5699, FPR95: 0.9638, AUPR_IN: 0.3677, AUPR_OUT: 0.7423
to spreadsheet: 0.5779349606649544,0.9585657370517928,0.4835544739171781,0.6429524107552353,0.5579995684979534,0.9716646989374262,0.5840521829214275,0.5251252700373279,0.5699020029268717,0.9638439581351094,0.3677003252366402,0.7423139944126618

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.699238578680203, Clf Bal Acc: 0.6140488741620664
SRC->TAR1:      AUROC: 0.6844, FPR95: 0.8980, AUPR_IN: 0.5879, AUPR_OUT: 0.7407
SRC->TAR2:      AUROC: 0.6972, FPR95: 0.8713, AUPR_IN: 0.6881, AUPR_OUT: 0.6770
SRC->TAR1+TAR2: AUROC: 0.6896, FPR95: 0.8873, AUPR_IN: 0.4771, AUPR_OUT: 0.8309
to spreadsheet: 0.6843873238012418,0.8980079681274901,0.5879422142206826,0.7407190673907786,0.697206923210615,0.8713105076741441,0.688131279042449,0.6769803496570492,0.6895529758943622,0.8872502378686965,0.4770551094506831,0.830875343322542

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6068, FPR95: 0.9355, AUPR_IN: 0.5040, AUPR_OUT: 0.6771
SRC->TAR2:      AUROC: 0.6373, FPR95: 0.9315, AUPR_IN: 0.6516, AUPR_OUT: 0.6055
SRC->TAR1+TAR2: AUROC: 0.6191, FPR95: 0.9339, AUPR_IN: 0.4047, AUPR_OUT: 0.7837
to spreadsheet: 0.6067688636317673,0.9354581673306773,0.5039599146547205,0.677120557088187,0.6373060488196621,0.9315230224321134,0.6516172306848383,0.605451073337133,0.6190738093283168,0.933872502378687,0.4046970103498563,0.7837345519312546
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [00:42<00:00, 18.36it/s]
100% 1255/1255 [01:07<00:00, 18.58it/s]
100% 847/847 [00:45<00:00, 18.59it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6563, FPR95: 0.8932, AUPR_IN: 0.5182, AUPR_OUT: 0.7380
SRC->TAR2:      AUROC: 0.6529, FPR95: 0.8843, AUPR_IN: 0.6216, AUPR_OUT: 0.6485
SRC->TAR1+TAR2: AUROC: 0.6550, FPR95: 0.8896, AUPR_IN: 0.3967, AUPR_OUT: 0.8217
to spreadsheet: 0.6563234372156046,0.8932270916334661,0.5181603844207281,0.7379725370168394,0.6529157851838978,0.8842975206611571,0.6216092938486824,0.6484620706131443,0.6549503252884611,0.8896289248334919,0.3966546144063561,0.821688217255106
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [00:17<00:00, 45.82it/s]
100% 1255/1255 [00:27<00:00, 46.06it/s]
100% 847/847 [00:18<00:00, 45.55it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6584, FPR95: 0.8805, AUPR_IN: 0.5187, AUPR_OUT: 0.7397
SRC->TAR2:      AUROC: 0.6511, FPR95: 0.8737, AUPR_IN: 0.6194, AUPR_OUT: 0.6470
SRC->TAR1+TAR2: AUROC: 0.6555, FPR95: 0.8777, AUPR_IN: 0.3959, AUPR_OUT: 0.8221
to spreadsheet: 0.6583877687220661,0.8804780876494024,0.5186958096277492,0.7397273165833869,0.6511425814609939,0.8736717827626919,0.61944237085539,0.6470425439689724,0.6554683236173429,0.8777354900095148,0.3959446151773664,0.8220752296077487
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [00:26<00:00, 29.73it/s]
100% 1255/1255 [00:42<00:00, 29.88it/s]
100% 847/847 [00:28<00:00, 29.83it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6458, FPR95: 0.8773, AUPR_IN: 0.5312, AUPR_OUT: 0.7290
SRC->TAR2:      AUROC: 0.6054, FPR95: 0.8914, AUPR_IN: 0.5813, AUPR_OUT: 0.6084
SRC->TAR1+TAR2: AUROC: 0.6296, FPR95: 0.8830, AUPR_IN: 0.3905, AUPR_OUT: 0.8076
to spreadsheet: 0.6458298784557202,0.8772908366533865,0.5311878211650694,0.7289845048638406,0.605442319563224,0.8913813459268005,0.5812745524281205,0.6084204703314229,0.6295557288924737,0.8829686013320647,0.39045201053256273,0.8075837142184543
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 486/486 [00:04<00:00, 118.80it/s]
t = 2.8478
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=2.8478)...
React - using SR2 test to compute threshold
100% 788/788 [00:17<00:00, 45.66it/s]
100% 1255/1255 [00:27<00:00, 46.03it/s]
100% 847/847 [00:18<00:00, 45.85it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6654, FPR95: 0.8797, AUPR_IN: 0.5377, AUPR_OUT: 0.7420
SRC->TAR2:      AUROC: 0.6577, FPR95: 0.8737, AUPR_IN: 0.6399, AUPR_OUT: 0.6495
SRC->TAR1+TAR2: AUROC: 0.6623, FPR95: 0.8773, AUPR_IN: 0.4195, AUPR_OUT: 0.8239
to spreadsheet: 0.6654013388072078,0.8796812749003984,0.537722951975842,0.7419766972683657,0.6576720464583871,0.8736717827626919,0.6398592680431092,0.6495011331449082,0.6622868237646524,0.8772597526165556,0.4194767830893885,0.8238680800404885
################################################################################