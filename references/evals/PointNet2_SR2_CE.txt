Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/pn2-msg.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='PointNet2_CE_SR2_eval', eval_step=1, save_step=10, ckpt_path='outputs/PointNet2_CE_SR2/models/model_last.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
Clf - feature encoder: pn2-msg
Clf Head - num classes: 4, input dim: 1024, act: relu, dropout: 0.5
Model params count: 1.7373 M
Load weights:  <All keys matched successfully>
100% 788/788 [02:24<00:00,  5.45it/s]
100% 1255/1255 [03:47<00:00,  5.52it/s]
100% 847/847 [02:33<00:00,  5.53it/s]

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8375634517766497, Clf Bal Acc: 0.8288544079306779
SRC->TAR1:      AUROC: 0.7091, FPR95: 0.8693, AUPR_IN: 0.6457, AUPR_OUT: 0.7627
SRC->TAR2:      AUROC: 0.7072, FPR95: 0.8689, AUPR_IN: 0.7014, AUPR_OUT: 0.6837
SRC->TAR1+TAR2: AUROC: 0.7084, FPR95: 0.8692, AUPR_IN: 0.5240, AUPR_OUT: 0.8420
to spreadsheet: 0.7091153153881934,0.8693227091633466,0.6457315845797295,0.7627069668262041,0.7072423423369433,0.8689492325855962,0.7014246224726973,0.6837335260327453,0.7083606016991311,0.8691722169362512,0.5240158765997396,0.8420481512326493
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8375634517766497, Clf Bal Acc: 0.8288544079306779
SRC->TAR1:      AUROC: 0.7077, FPR95: 0.8183, AUPR_IN: 0.6358, AUPR_OUT: 0.7731
SRC->TAR2:      AUROC: 0.7022, FPR95: 0.8548, AUPR_IN: 0.6937, AUPR_OUT: 0.6828
SRC->TAR1+TAR2: AUROC: 0.7055, FPR95: 0.8330, AUPR_IN: 0.5125, AUPR_OUT: 0.8460
to spreadsheet: 0.7077143203834407,0.8183266932270916,0.6358287017680389,0.7731338237533474,0.7022141448768122,0.8547815820543093,0.6936995233040308,0.6828259072291833,0.7054980270180199,0.8330161750713606,0.5124643987873392,0.8460314852044357
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8375634517766497, Clf Bal Acc: 0.8288544079306779
SRC->TAR1:      AUROC: 0.7119, FPR95: 0.8558, AUPR_IN: 0.6469, AUPR_OUT: 0.7730
SRC->TAR2:      AUROC: 0.7083, FPR95: 0.8784, AUPR_IN: 0.7023, AUPR_OUT: 0.6887
SRC->TAR1+TAR2: AUROC: 0.7104, FPR95: 0.8649, AUPR_IN: 0.5252, AUPR_OUT: 0.8474
to spreadsheet: 0.7118621958865047,0.8557768924302789,0.6469296682004358,0.773004762194466,0.7083031182015953,0.8783943329397875,0.7023139398598676,0.688657512133728,0.7104280670572382,0.8648905803996194,0.5252404721321304,0.8473636374644354
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
100% 1916/1916 [05:34<00:00,  5.72it/s]
100% 788/788 [02:18<00:00,  5.71it/s]
100% 1255/1255 [03:39<00:00,  5.71it/s]
100% 847/847 [02:28<00:00,  5.71it/s]
Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8362944162436549, Clf Bal Acc: 0.8241380624246815
SRC->TAR1:      AUROC: 0.6861, FPR95: 0.8032, AUPR_IN: 0.5712, AUPR_OUT: 0.7637
SRC->TAR2:      AUROC: 0.7158, FPR95: 0.8146, AUPR_IN: 0.6963, AUPR_OUT: 0.7076
SRC->TAR1+TAR2: AUROC: 0.6981, FPR95: 0.8078, AUPR_IN: 0.4655, AUPR_OUT: 0.8472
to spreadsheet: 0.6861144255465448,0.803187250996016,0.5712158156360082,0.7636994008291085,0.7157645077580472,0.8146399055489965,0.6963008531131369,0.7076266470209971,0.6980619134785822,0.807802093244529,0.46546101770121145,0.8472125832096872

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6970, FPR95: 0.8558, AUPR_IN: 0.6138, AUPR_OUT: 0.7640
SRC->TAR2:      AUROC: 0.6831, FPR95: 0.8937, AUPR_IN: 0.6956, AUPR_OUT: 0.6526
SRC->TAR1+TAR2: AUROC: 0.6914, FPR95: 0.8711, AUPR_IN: 0.5014, AUPR_OUT: 0.8352
to spreadsheet: 0.6970210528444597,0.8557768924302789,0.6138365352674022,0.7640468542840173,0.6831411551070066,0.8937426210153483,0.6955648231695349,0.6525798834990899,0.6914281539940207,0.8710751665080876,0.5013993880392813,0.8351965340409004

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8324873096446701, Clf Bal Acc: 0.8366754121571531
SRC->TAR1:      AUROC: 0.6910, FPR95: 0.9100, AUPR_IN: 0.6002, AUPR_OUT: 0.7336
SRC->TAR2:      AUROC: 0.7192, FPR95: 0.9268, AUPR_IN: 0.7251, AUPR_OUT: 0.6686
SRC->TAR1+TAR2: AUROC: 0.7024, FPR95: 0.9167, AUPR_IN: 0.5026, AUPR_OUT: 0.8259
to spreadsheet: 0.6909943980423484,0.9099601593625498,0.6002141060120872,0.7336122031569392,0.7192210189441384,0.9268004722550177,0.7251142597578529,0.6686225549936132,0.7023683028491117,0.9167459562321598,0.5026337879215019,0.8258961896531098

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6639, FPR95: 0.9060, AUPR_IN: 0.5634, AUPR_OUT: 0.7143
SRC->TAR2:      AUROC: 0.6963, FPR95: 0.9209, AUPR_IN: 0.7005, AUPR_OUT: 0.6486
SRC->TAR1+TAR2: AUROC: 0.6769, FPR95: 0.9120, AUPR_IN: 0.4654, AUPR_OUT: 0.8118
to spreadsheet: 0.6638572613100897,0.9059760956175299,0.5633646446932451,0.7143472086935004,0.6962884830905136,0.9208972845336482,0.700459601609513,0.6486103893173899,0.676925408240641,0.911988582302569,0.4653632085477981,0.811841723705248
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
100% 788/788 [05:18<00:00,  2.47it/s]
100% 1255/1255 [08:29<00:00,  2.46it/s]
100% 847/847 [05:42<00:00,  2.47it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7177, FPR95: 0.8351, AUPR_IN: 0.6532, AUPR_OUT: 0.7760
SRC->TAR2:      AUROC: 0.7137, FPR95: 0.8701, AUPR_IN: 0.7127, AUPR_OUT: 0.6864
SRC->TAR1+TAR2: AUROC: 0.7161, FPR95: 0.8492, AUPR_IN: 0.5365, AUPR_OUT: 0.8485
to spreadsheet: 0.7177184662365765,0.8350597609561753,0.6532067042871057,0.7760168805377687,0.7136789145326294,0.8701298701298701,0.7127312175553928,0.6864197448207585,0.7160907306070602,0.8491912464319695,0.5364835307865359,0.8484677292042135
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
100% 788/788 [02:23<00:00,  5.49it/s]
100% 1255/1255 [03:48<00:00,  5.49it/s]
100% 847/847 [02:35<00:00,  5.45it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7113, FPR95: 0.8104, AUPR_IN: 0.6378, AUPR_OUT: 0.7826
SRC->TAR2:      AUROC: 0.7030, FPR95: 0.8678, AUPR_IN: 0.6954, AUPR_OUT: 0.6862
SRC->TAR1+TAR2: AUROC: 0.7080, FPR95: 0.8335, AUPR_IN: 0.5145, AUPR_OUT: 0.8506
to spreadsheet: 0.7113303132647076,0.8103585657370518,0.6377708577908998,0.7826362859494116,0.702991747523358,0.8677685950413223,0.6953893000370115,0.6861649761846578,0.7079702917695015,0.8334919124643198,0.5144950100686977,0.8506172309715655
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...
100% 788/788 [02:30<00:00,  5.23it/s]
100% 1255/1255 [04:00<00:00,  5.22it/s]
100% 847/847 [02:41<00:00,  5.26it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7420, FPR95: 0.8143, AUPR_IN: 0.6709, AUPR_OUT: 0.7896
SRC->TAR2:      AUROC: 0.7067, FPR95: 0.8607, AUPR_IN: 0.6956, AUPR_OUT: 0.6799
SRC->TAR1+TAR2: AUROC: 0.7277, FPR95: 0.8330, AUPR_IN: 0.5339, AUPR_OUT: 0.8530
to spreadsheet: 0.741958056100471,0.8143426294820717,0.6709151816594765,0.7896157722332524,0.7066804907137165,0.8606847697756789,0.6956441123913465,0.6798516427142227,0.7277429762324497,0.8330161750713606,0.5338657902570755,0.8530242150917797
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
100% 486/486 [01:28<00:00,  5.49it/s]
t = 1.6708
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=1.6708)...
React - using SR2 test to compute threshold
100% 788/788 [02:24<00:00,  5.44it/s]
100% 1255/1255 [03:50<00:00,  5.44it/s]
100% 847/847 [02:36<00:00,  5.42it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7049, FPR95: 0.8398, AUPR_IN: 0.6292, AUPR_OUT: 0.7728
SRC->TAR2:      AUROC: 0.7048, FPR95: 0.8808, AUPR_IN: 0.7016, AUPR_OUT: 0.6796
SRC->TAR1+TAR2: AUROC: 0.7048, FPR95: 0.8563, AUPR_IN: 0.5139, AUPR_OUT: 0.8454
to spreadsheet: 0.7048880619653367,0.8398406374501992,0.6292259818649251,0.7728471460232874,0.7047761882787262,0.8807556080283353,0.7015821161811798,0.6795642037407372,0.7048429825112171,0.8563273073263559,0.5138628832803228,0.8454103167708602
################################################################################