Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/pn2-msg.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='PointNet2_CE_SR1_eval', eval_step=1, save_step=10, ckpt_path='outputs/PointNet2_CE_SR1/models/model_last.pth', src='SR1', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_train.h5
ModelNet40_OOD - split: train, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
SR1 train data len: 2378
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
Src is SR1

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
Clf - feature encoder: pn2-msg
Clf Head - num classes: 5, input dim: 1024, act: relu, dropout: 0.5
Model params count: 1.7376 M
Load weights:  <All keys matched successfully>
100% 1255/1255 [03:47<00:00,  5.51it/s]
100% 788/788 [02:21<00:00,  5.56it/s]
100% 847/847 [02:32<00:00,  5.57it/s]

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7880478087649403, Clf Bal Acc: 0.7601842402730187
SRC->TAR1:      AUROC: 0.8303, FPR95: 0.7868, AUPR_IN: 0.9065, AUPR_OUT: 0.6871
SRC->TAR2:      AUROC: 0.8007, FPR95: 0.8217, AUPR_IN: 0.8756, AUPR_OUT: 0.6633
SRC->TAR1+TAR2: AUROC: 0.8150, FPR95: 0.8049, AUPR_IN: 0.8227, AUPR_OUT: 0.8040
to spreadsheet: 0.8303319716059621,0.7868020304568528,0.9065130876298273,0.6870755067043254,0.8007008565501865,0.8217237308146399,0.8755981245277531,0.6633412938314782,0.8149817853966397,0.8048929663608563,0.8226574816357872,0.8039932502158722
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7880478087649403, Clf Bal Acc: 0.7601842402730187
SRC->TAR1:      AUROC: 0.8387, FPR95: 0.7881, AUPR_IN: 0.9105, AUPR_OUT: 0.7079
SRC->TAR2:      AUROC: 0.8159, FPR95: 0.7792, AUPR_IN: 0.8798, AUPR_OUT: 0.7111
SRC->TAR1+TAR2: AUROC: 0.8269, FPR95: 0.7835, AUPR_IN: 0.8273, AUPR_OUT: 0.8269
to spreadsheet: 0.8386747426537504,0.7880710659898477,0.9104646763179911,0.707941129064468,0.8158666396985846,0.7792207792207793,0.879780636155224,0.7111044393943242,0.8268591688292701,0.7834862385321101,0.827304631431877,0.826851954388956
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7880478087649403, Clf Bal Acc: 0.7601842402730187
SRC->TAR1:      AUROC: 0.8318, FPR95: 0.7906, AUPR_IN: 0.9070, AUPR_OUT: 0.6944
SRC->TAR2:      AUROC: 0.8040, FPR95: 0.8158, AUPR_IN: 0.8766, AUPR_OUT: 0.6819
SRC->TAR1+TAR2: AUROC: 0.8174, FPR95: 0.8037, AUPR_IN: 0.8235, AUPR_OUT: 0.8123
to spreadsheet: 0.8317713915909963,0.7906091370558376,0.9070377260195763,0.6944451111099025,0.8040085231682479,0.8158205430932703,0.8765602876565566,0.6818836013661391,0.8173890371236765,0.8036697247706422,0.823492169725998,0.8123116443796109
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
100% 2378/2378 [06:53<00:00,  5.75it/s]
100% 1255/1255 [03:37<00:00,  5.76it/s]
100% 788/788 [02:18<00:00,  5.70it/s]
100% 847/847 [02:27<00:00,  5.72it/s]
Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7800796812749003, Clf Bal Acc: 0.7295998579845964
SRC->TAR1:      AUROC: 0.7895, FPR95: 0.8503, AUPR_IN: 0.8799, AUPR_OUT: 0.6084
SRC->TAR2:      AUROC: 0.7768, FPR95: 0.8253, AUPR_IN: 0.8472, AUPR_OUT: 0.6427
SRC->TAR1+TAR2: AUROC: 0.7829, FPR95: 0.8373, AUPR_IN: 0.7774, AUPR_OUT: 0.7694
to spreadsheet: 0.7894695330353713,0.850253807106599,0.8798644277908352,0.6084406260989913,0.7768237557444367,0.8252656434474617,0.8471785574553086,0.6427102711751561,0.7829184789892417,0.8373088685015291,0.777387620593109,0.7694160707108589

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.21274900398406374, Clf Bal Acc: 0.2
SRC->TAR1:      AUROC: 0.7910, FPR95: 0.8731, AUPR_IN: 0.8820, AUPR_OUT: 0.6165
SRC->TAR2:      AUROC: 0.7484, FPR95: 0.8902, AUPR_IN: 0.8264, AUPR_OUT: 0.5909
SRC->TAR1+TAR2: AUROC: 0.7690, FPR95: 0.8820, AUPR_IN: 0.7622, AUPR_OUT: 0.7516
to spreadsheet: 0.7910156328998725,0.8730964467005076,0.8819619554619551,0.6164607819561482,0.7484376543413125,0.8902007083825265,0.8264046366865225,0.5909305645224705,0.7689584170961414,0.8819571865443425,0.7621623288590522,0.7516274007210122

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.803187250996016, Clf Bal Acc: 0.774792246099795
SRC->TAR1:      AUROC: 0.8051, FPR95: 0.8160, AUPR_IN: 0.8870, AUPR_OUT: 0.6497
SRC->TAR2:      AUROC: 0.7810, FPR95: 0.8347, AUPR_IN: 0.8510, AUPR_OUT: 0.6411
SRC->TAR1+TAR2: AUROC: 0.7926, FPR95: 0.8257, AUPR_IN: 0.7852, AUPR_OUT: 0.7826
to spreadsheet: 0.8051090056019576,0.815989847715736,0.8870372640137469,0.6497389622978458,0.7810298357926028,0.8347107438016529,0.8510399457195597,0.6411055588292797,0.7926349647282429,0.8256880733944955,0.7852013452282411,0.782575640004993

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.21274900398406374, Clf Bal Acc: 0.2
SRC->TAR1:      AUROC: 0.7613, FPR95: 0.8376, AUPR_IN: 0.8529, AUPR_OUT: 0.6011
SRC->TAR2:      AUROC: 0.7198, FPR95: 0.9150, AUPR_IN: 0.8037, AUPR_OUT: 0.5591
SRC->TAR1+TAR2: AUROC: 0.7398, FPR95: 0.8777, AUPR_IN: 0.7221, AUPR_OUT: 0.7326
to spreadsheet: 0.7613444698363905,0.8375634517766497,0.8529404907165279,0.6010940799990824,0.7197514546301218,0.9149940968122786,0.8036909070602617,0.5591246428276233,0.7397975072188311,0.8776758409785933,0.7221403148072166,0.7325613110477652
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
100% 1255/1255 [08:31<00:00,  2.45it/s]
100% 788/788 [05:19<00:00,  2.46it/s]
100% 847/847 [05:45<00:00,  2.45it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8285, FPR95: 0.8058, AUPR_IN: 0.9042, AUPR_OUT: 0.6871
SRC->TAR2:      AUROC: 0.8074, FPR95: 0.7863, AUPR_IN: 0.8706, AUPR_OUT: 0.7021
SRC->TAR1+TAR2: AUROC: 0.8175, FPR95: 0.7957, AUPR_IN: 0.8145, AUPR_OUT: 0.8171
to spreadsheet: 0.8284804942665884,0.8058375634517766,0.9042293561420623,0.6870761720238272,0.8073622863916236,0.7863046044864227,0.8705832399023739,0.7021263348888116,0.8175403584439003,0.7957186544342507,0.8144854352158957,0.8171400418696271
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
100% 1255/1255 [03:48<00:00,  5.49it/s]
100% 788/788 [02:23<00:00,  5.48it/s]
100% 847/847 [02:34<00:00,  5.47it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8388, FPR95: 0.8033, AUPR_IN: 0.9097, AUPR_OUT: 0.6983
SRC->TAR2:      AUROC: 0.8220, FPR95: 0.7226, AUPR_IN: 0.8818, AUPR_OUT: 0.7226
SRC->TAR1+TAR2: AUROC: 0.8301, FPR95: 0.7615, AUPR_IN: 0.8277, AUPR_OUT: 0.8288
to spreadsheet: 0.8388334984933363,0.8032994923857868,0.9097143656810769,0.698263629497033,0.8220454663047926,0.7225501770956316,0.8818053085783761,0.7225800815075412,0.830136579065999,0.7614678899082569,0.8276928406040502,0.828811423955562
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...
100% 1255/1255 [04:00<00:00,  5.22it/s]
100% 788/788 [02:30<00:00,  5.23it/s]
100% 847/847 [02:42<00:00,  5.22it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8119, FPR95: 0.7817, AUPR_IN: 0.8866, AUPR_OUT: 0.6755
SRC->TAR2:      AUROC: 0.7776, FPR95: 0.7651, AUPR_IN: 0.8322, AUPR_OUT: 0.6720
SRC->TAR1+TAR2: AUROC: 0.7941, FPR95: 0.7731, AUPR_IN: 0.7653, AUPR_OUT: 0.8015
to spreadsheet: 0.8119471353166016,0.7817258883248731,0.8866341770552696,0.6754688121681287,0.7775669459117486,0.7650531286894924,0.8322114196627964,0.6719802674817621,0.7941367252701732,0.7730886850152905,0.7652631999483249,0.8014629772537029
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
React Val - SR1 data len: 340
100% 340/340 [01:01<00:00,  5.50it/s]
t = 1.4133
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=1.4133)...
React - using SR1 test to compute threshold
100% 1255/1255 [03:50<00:00,  5.45it/s]
100% 788/788 [02:25<00:00,  5.43it/s]
100% 847/847 [02:35<00:00,  5.44it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.8195, FPR95: 0.7386, AUPR_IN: 0.8891, AUPR_OUT: 0.6929
SRC->TAR2:      AUROC: 0.8164, FPR95: 0.7178, AUPR_IN: 0.8765, AUPR_OUT: 0.7223
SRC->TAR1+TAR2: AUROC: 0.8179, FPR95: 0.7278, AUPR_IN: 0.8060, AUPR_OUT: 0.8257
to spreadsheet: 0.8195360689222804,0.7385786802030457,0.8891068175599239,0.6928940201005158,0.8164414361444423,0.717827626918536,0.876470059935083,0.7222707065409393,0.8179329166514371,0.72782874617737,0.8059566347220579,0.8257257458671177
################################################################################