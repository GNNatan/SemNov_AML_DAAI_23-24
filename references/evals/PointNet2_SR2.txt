Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/pn2-msg.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='./3D_OS_release_data', checkpoints_dir='outputs', exp_name='PointNet2_CE_SR2_eval', eval_step=1, save_step=10, ckpt_path='outputs/PointNet2_CE_SR2/models/model_last.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 404, 1: 404, 2: 404, 3: 404, 11: 404}, num samples: 847
Clf - feature encoder: pn2-msg
Clf Head - num classes: 4, input dim: 1024, act: relu, dropout: 0.5
Model params count: 1.7373 M
Load weights:  <All keys matched successfully>
100% 788/788 [02:33<00:00,  5.14it/s]
100% 1255/1255 [04:01<00:00,  5.20it/s]
100% 847/847 [02:42<00:00,  5.21it/s]

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.817258883248731, Clf Bal Acc: 0.788209644916962
SRC->TAR1:      AUROC: 0.6876, FPR95: 0.8861, AUPR_IN: 0.5642, AUPR_OUT: 0.7407
SRC->TAR2:      AUROC: 0.7339, FPR95: 0.8560, AUPR_IN: 0.7143, AUPR_OUT: 0.7034
SRC->TAR1+TAR2: AUROC: 0.7063, FPR95: 0.8739, AUPR_IN: 0.4664, AUPR_OUT: 0.8376
to spreadsheet: 0.6876352458187553,0.8860557768924303,0.5641535396349768,0.7406887647540622,0.7339228030852397,0.8559622195985832,0.7142831188969441,0.7034002939463373,0.7062867972006356,0.8739295908658421,0.46636145038390686,0.8376035274635549
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.817258883248731, Clf Bal Acc: 0.788209644916962
SRC->TAR1:      AUROC: 0.6440, FPR95: 0.8908, AUPR_IN: 0.5366, AUPR_OUT: 0.7241
SRC->TAR2:      AUROC: 0.6846, FPR95: 0.8666, AUPR_IN: 0.6436, AUPR_OUT: 0.6787
SRC->TAR1+TAR2: AUROC: 0.6604, FPR95: 0.8811, AUPR_IN: 0.4229, AUPR_OUT: 0.8233
to spreadsheet: 0.6440046918923292,0.8908366533864542,0.5365958103919803,0.7240849627315147,0.6845779969914718,0.8665879574970484,0.6435782850225569,0.6787430025117558,0.6603536878100141,0.8810656517602283,0.4228538617064176,0.8233125318268497
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.817258883248731, Clf Bal Acc: 0.788209644916962
SRC->TAR1:      AUROC: 0.6894, FPR95: 0.8765, AUPR_IN: 0.5648, AUPR_OUT: 0.7452
SRC->TAR2:      AUROC: 0.7338, FPR95: 0.8583, AUPR_IN: 0.7143, AUPR_OUT: 0.7019
SRC->TAR1+TAR2: AUROC: 0.7073, FPR95: 0.8692, AUPR_IN: 0.4668, AUPR_OUT: 0.8391
to spreadsheet: 0.6893643699314418,0.8764940239043825,0.56482890373036,0.7452267926208853,0.733755745869267,0.8583234946871311,0.7142840367549687,0.7019189724674031,0.7072518558588146,0.8691722169362512,0.4667628006001465,0.8391102574996467
################################################################################

################################################################################
Computing OOD metrics with distance from train features...
  0% 0/1916 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 1916/1916 [06:04<00:00,  5.26it/s]
100% 788/788 [02:31<00:00,  5.21it/s]
100% 1255/1255 [04:01<00:00,  5.21it/s]
100% 847/847 [02:42<00:00,  5.22it/s]
Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8071065989847716, Clf Bal Acc: 0.7847490048069485
SRC->TAR1:      AUROC: 0.7145, FPR95: 0.8502, AUPR_IN: 0.6148, AUPR_OUT: 0.7740
SRC->TAR2:      AUROC: 0.7406, FPR95: 0.8017, AUPR_IN: 0.7125, AUPR_OUT: 0.7247
SRC->TAR1+TAR2: AUROC: 0.7250, FPR95: 0.8306, AUPR_IN: 0.5022, AUPR_OUT: 0.8564
to spreadsheet: 0.7145317208324063,0.850199203187251,0.6147600303668341,0.7739947153087601,0.7406208235696007,0.8016528925619835,0.7124875488941135,0.7246595256443807,0.7250443136099534,0.8306374881065651,0.5021535509514397,0.8563638809219989

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.7034, FPR95: 0.8781, AUPR_IN: 0.6028, AUPR_OUT: 0.7604
SRC->TAR2:      AUROC: 0.7303, FPR95: 0.8571, AUPR_IN: 0.7046, AUPR_OUT: 0.7056
SRC->TAR1+TAR2: AUROC: 0.7142, FPR95: 0.8696, AUPR_IN: 0.4897, AUPR_OUT: 0.8463
to spreadsheet: 0.703426901530932,0.8780876494023905,0.6028325404598351,0.7603978987941247,0.7302812554312323,0.8571428571428571,0.704627058807787,0.7055929148273783,0.7142478519369998,0.8696479543292103,0.4897256400984438,0.8463420105464068

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8058375634517766, Clf Bal Acc: 0.7817002243191437
SRC->TAR1:      AUROC: 0.6984, FPR95: 0.8781, AUPR_IN: 0.6066, AUPR_OUT: 0.7551
SRC->TAR2:      AUROC: 0.7333, FPR95: 0.8170, AUPR_IN: 0.7127, AUPR_OUT: 0.7188
SRC->TAR1+TAR2: AUROC: 0.7125, FPR95: 0.8535, AUPR_IN: 0.4994, AUPR_OUT: 0.8472
to spreadsheet: 0.6984442938904282,0.8780876494023905,0.6066458364279483,0.7550722591210693,0.7332665603893107,0.8170011806375442,0.7126623730594184,0.7188425014592006,0.712475911266524,0.8534728829686014,0.49936704755122857,0.8472068257183509

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713197969543147, Clf Bal Acc: 0.25
SRC->TAR1:      AUROC: 0.6834, FPR95: 0.8900, AUPR_IN: 0.5748, AUPR_OUT: 0.7427
SRC->TAR2:      AUROC: 0.7215, FPR95: 0.8512, AUPR_IN: 0.6939, AUPR_OUT: 0.7011
SRC->TAR1+TAR2: AUROC: 0.6988, FPR95: 0.8744, AUPR_IN: 0.4664, AUPR_OUT: 0.8377
to spreadsheet: 0.6833827128036079,0.8900398406374502,0.5747660598011419,0.7426969354736124,0.7215380950383258,0.8512396694214877,0.6939397458398836,0.7011215566084087,0.6987574077383396,0.8744053282588011,0.46636873579853794,0.837691261860164
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [05:48<00:00,  2.26it/s]
100% 1255/1255 [09:18<00:00,  2.25it/s]
100% 847/847 [06:15<00:00,  2.25it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6913, FPR95: 0.8693, AUPR_IN: 0.5705, AUPR_OUT: 0.7531
SRC->TAR2:      AUROC: 0.7293, FPR95: 0.8489, AUPR_IN: 0.7049, AUPR_OUT: 0.7048
SRC->TAR1+TAR2: AUROC: 0.7066, FPR95: 0.8611, AUPR_IN: 0.4671, AUPR_OUT: 0.8430
to spreadsheet: 0.6912932028232248,0.8693227091633466,0.5705444766645332,0.7531180737190754,0.7292826578128839,0.8488783943329398,0.7048869854421227,0.7047951491915756,0.7066010374456042,0.8610846812559467,0.4670945981859886,0.8429656742457582
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [02:38<00:00,  4.97it/s]
100% 1255/1255 [04:13<00:00,  4.94it/s]
100% 847/847 [02:50<00:00,  4.96it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6330, FPR95: 0.8892, AUPR_IN: 0.5255, AUPR_OUT: 0.7254
SRC->TAR2:      AUROC: 0.6656, FPR95: 0.8831, AUPR_IN: 0.6265, AUPR_OUT: 0.6669
SRC->TAR1+TAR2: AUROC: 0.6461, FPR95: 0.8868, AUPR_IN: 0.4081, AUPR_OUT: 0.8203
to spreadsheet: 0.6329736890003438,0.8892430278884462,0.5255008962428027,0.7254478442182541,0.6655574467065006,0.8831168831168831,0.6264936264038224,0.6668638777579259,0.646103300216859,0.8867745004757374,0.4081186927653695,0.8203049396177671
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...
  0% 0/788 [00:00<?, ?it/s]/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 788/788 [02:51<00:00,  4.61it/s]
100% 1255/1255 [04:31<00:00,  4.63it/s]
100% 847/847 [03:03<00:00,  4.62it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.7039, FPR95: 0.8693, AUPR_IN: 0.6026, AUPR_OUT: 0.7552
SRC->TAR2:      AUROC: 0.7191, FPR95: 0.8619, AUPR_IN: 0.6914, AUPR_OUT: 0.6948
SRC->TAR1+TAR2: AUROC: 0.7100, FPR95: 0.8663, AUPR_IN: 0.4835, AUPR_OUT: 0.8415
to spreadsheet: 0.703929459825672,0.8693227091633466,0.6025658881974019,0.7551613397052679,0.7191011572645167,0.8618654073199528,0.6913591047413097,0.6947580462500589,0.7100428888126851,0.8663177925784966,0.4834580753073448,0.8415434187867612
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: ./3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
100% 486/486 [01:37<00:00,  5.00it/s]
t = 0.0892
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=0.0892)...
React - using SR2 test to compute threshold
100% 788/788 [02:39<00:00,  4.93it/s]
100% 1255/1255 [04:14<00:00,  4.93it/s]
100% 847/847 [02:51<00:00,  4.94it/s]
AUROC - Src label: 1, Tar label: 0
SRC->TAR1:      AUROC: 0.6138, FPR95: 0.8709, AUPR_IN: 0.4976, AUPR_OUT: 0.7153
SRC->TAR2:      AUROC: 0.6553, FPR95: 0.8725, AUPR_IN: 0.6148, AUPR_OUT: 0.6608
SRC->TAR1+TAR2: AUROC: 0.6306, FPR95: 0.8716, AUPR_IN: 0.3862, AUPR_OUT: 0.8143
to spreadsheet: 0.6138461382894816,0.8709163346613545,0.49760846895540434,0.7153497308810651,0.6553362419767588,0.872491145218418,0.6147918418216407,0.6608107035584361,0.6305645578057157,0.8715509039010466,0.38620018102993375,0.8143464325131617
################################################################################